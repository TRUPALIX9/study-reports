<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L04: Ready, Set, Stop That Threat! - WordPress Threat Modeling Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c3e50;
        }
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .diagram-section {
            margin: 40px 0;
            padding: 30px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background-color: #fafafa;
        }
        .diagram-section h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .diagram-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .description {
            background-color: #e8f4f8;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
        .description h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .requirements {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .requirements h4 {
            color: #856404;
            margin-top: 0;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #ecf0f1;
            color: #7f8c8d;
        }
        .mermaid {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>L04: Ready, Set, Stop That Threat!</h1>
            <p><strong>WordPress Threat Modeling Analysis</strong></p>
            <p>©2025 Richard Zins CC BY-NC-SA 4.0</p>
            <p>Student: Trupal Patel | Course: Cybersecurity Threat Modeling</p>
        </div>

        <!-- Task 2: Data Flow Diagram -->
        <div class="diagram-section">
            <h2>Task 2: Data Flow Diagram (DFD) - 3 Points</h2>
            
            <div class="requirements">
                <h4>Requirements Met:</h4>
                <ul>
                    <li>✅ 2 data flows (User Request Processing + Admin Operations)</li>
                    <li>✅ 2 boundaries (Environment + Data)</li>
                    <li>✅ Proper threat modeling shapes (External Entity, Process, Data Store, Trust Boundary)</li>
                </ul>
            </div>

            <div class="description">
                <h3>Enhanced User Browser Representation</h3>
                <p>The DFD includes detailed User Browser components with modern security features including SSL/TLS encryption, cookie management, and session storage capabilities.</p>
            </div>

            <div class="diagram-container">
                <div class="mermaid">
graph TD
    %% External Entities - Top Level
    User[("User Browser<br/>Chrome/Firefox/Safari<br/>SSL/TLS Encryption<br/>Cookie Management<br/>Session Storage")]
    Admin[("Admin Dashboard<br/>WordPress Admin Panel<br/>Elevated Privileges<br/>Content Management<br/>Plugin Configuration")]
    
    %% Trust Boundary 1: Environment - Middle Level
    subgraph TB1 ["Environment Boundary: Internet to Web Server"]
        WebServer["Web Server<br/>Apache/Nginx<br/>Static File Serving<br/>Request Routing<br/>SSL/TLS Handling"]
    end
    
    %% Trust Boundary 2: Data - Bottom Level
    subgraph TB2 ["Data Boundary: Application to Database"]
        WordPressApp["WordPress Core<br/>Request Processing<br/>Plugin Execution<br/>Theme Rendering"]
        MySQL[("MySQL Database<br/>Posts & Pages<br/>User Accounts<br/>Plugin Data<br/>Configuration")]
    end
    
    %% Data Flow 1: User Request (Top to Bottom)
    User -->|"1. HTTPS Request"| WebServer
    WebServer -->|"2. Process Request"| WordPressApp
    WordPressApp -->|"3. Query Database"| MySQL
    MySQL -->|"4. Return Data"| WordPressApp
    WordPressApp -->|"5. Render HTML"| WebServer
    WebServer -->|"6. HTTPS Response"| User
    
    %% Data Flow 2: Admin Operations (Top to Bottom)
    Admin -->|"7. Admin Login"| WebServer
    WebServer -->|"8. Authenticate User"| WordPressApp
    WordPressApp -->|"9. Admin Database Query"| MySQL
    MySQL -->|"10. Admin Data Response"| WordPressApp
    WordPressApp -->|"11. Admin Interface"| WebServer
    WebServer -->|"12. Admin Dashboard"| Admin
    
    %% Styling
    classDef external fill:#e1f5fe,stroke:#2196f3,stroke-width:2px
    classDef process fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef datastore fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    classDef trustboundary fill:#fff3e0,stroke:#ff9800,stroke-width:3px,stroke-dasharray: 5 5
    
    class User,Admin external
    class WebServer,WordPressApp process
    class MySQL datastore
    class TB1,TB2 trustboundary
                </div>
            </div>

            <div class="description">
                <h3>Key Data Flows Explained</h3>
                <p><strong>Data Flow 1 (Steps 1-6):</strong> User Request Processing - Complete cycle from browser request to rendered page delivery</p>
                <p><strong>Data Flow 2 (Steps 7-12):</strong> Admin Operations - Secure authentication and dashboard access flow</p>
            </div>
        </div>

        <!-- Task 3: Threat Tree Diagram -->
        <div class="diagram-section">
            <h2>Task 3: Threat Tree Diagram (TTD) - 3 Points</h2>
            
            <div class="requirements">
                <h4>Requirements Met:</h4>
                <ul>
                    <li>✅ 3 vulnerabilities (Weak Authentication, SQL Injection, XSS)</li>
                    <li>✅ 3 countermeasures (MFA, Parameterized Queries, Input Sanitization)</li>
                    <li>✅ Proper threat tree structure (root → vulnerabilities → attack methods → countermeasures)</li>
                </ul>
            </div>

            <div class="diagram-container">
                <div class="mermaid">
graph TD
    %% Root Threat - Top Level
    Root["Compromise of WordPress<br/>Website Integrity and User Data"]
    
    %% Level 1 - Vulnerabilities - Second Level
    WeakAuth["Weak Authentication<br/>Weak passwords<br/>Missing 2FA<br/>Session hijacking"]
    SQLInj["SQL Injection<br/>Unsanitized input<br/>Dynamic queries<br/>Plugin vulnerabilities"]
    XSS["Cross-Site Scripting XSS<br/>Unescaped output<br/>Comment injection<br/>Stored/Reflected XSS"]
    
    %% Level 2 - Attack Methods - Third Level
    BruteForce["Brute Force Attacks"]
    PluginSQLi["Plugin SQL Injection"]
    CommentXSS["Comment XSS Injection"]
    
    %% Countermeasures - Bottom Level
    MFA["Multi-Factor Authentication<br/>Complex passwords<br/>2FA enforcement<br/>Session management"]
    ParamQueries["Parameterized Queries<br/>Prepared statements<br/>ORM frameworks<br/>Input validation"]
    InputSanit["Input Sanitization<br/>Output escaping<br/>Content Security Policy<br/>XSS prevention"]
    
    %% Connections - Root to Vulnerabilities
    Root --> WeakAuth
    Root --> SQLInj
    Root --> XSS
    
    %% Connections - Vulnerabilities to Attack Methods
    WeakAuth --> BruteForce
    SQLInj --> PluginSQLi
    XSS --> CommentXSS
    
    %% Countermeasures mapped to vulnerabilities
    MFA -.->|"Mitigates"| WeakAuth
    ParamQueries -.->|"Mitigates"| SQLInj
    InputSanit -.->|"Mitigates"| XSS
    
    %% Styling
    classDef root fill:#ffebee,stroke:#f44336,stroke-width:4px
    classDef vulnerability fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef attack fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef countermeasure fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    
    class Root root
    class WeakAuth,SQLInj,XSS vulnerability
    class BruteForce,PluginSQLi,CommentXSS attack
    class MFA,ParamQueries,InputSanit countermeasure
                </div>
            </div>

            <div class="description">
                <h3>Threat Tree Analysis</h3>
                <p>This diagram follows OWASP Top 10 web application security risks and shows direct 1:1 countermeasure mapping for each vulnerability type, demonstrating comprehensive threat modeling for WordPress.</p>
            </div>
        </div>

        <!-- Task 4: Use & Misuse Diagram -->
        <div class="diagram-section">
            <h2>Task 4: Use & Misuse Diagram (UMD) - 3 Points</h2>
            
            <div class="requirements">
                <h4>Requirements Met:</h4>
                <ul>
                    <li>✅ 3 use cases (User Login, Admin Post, User Comment)</li>
                    <li>✅ 3 misuse cases (Credential Stuffing, Malicious Upload, XSS Injection)</li>
                    <li>✅ "Threaten" and "Mitigation" connections clearly outlined</li>
                </ul>
            </div>

            <div class="diagram-container">
                <div class="mermaid">
graph LR
    %% Actors - Left Side
    User[("User")]
    Admin[("Admin")]
    Attacker[("Malicious Attacker")]
    
    %% Use Cases - Center Left
    UserLogin["User Logs Into Account"]
    AdminPost["Admin Publishes a Post"]
    UserComment["User Comments on a Post"]
    
    %% Misuse Cases - Center Right
    CredentialStuffing["Credential Stuffing Attack"]
    MaliciousUpload["Malicious File Upload"]
    CommentXSS["Comment XSS Injection"]
    
    %% Mitigations - Right Side
    RateLimit["Rate Limiting & MFA"]
    FileValidation["File Type Validation"]
    InputSanit["Input Sanitization"]
    
    %% Left to Right Flow - Legitimate Connections
    User --> UserLogin
    User --> UserComment
    Admin --> AdminPost
    
    %% Left to Right Flow - Attack Connections
    Attacker --> CredentialStuffing
    Attacker --> MaliciousUpload
    Attacker --> CommentXSS
    
    %% Left to Right Flow - Threaten Connections
    CredentialStuffing -->|"THREATENS"| UserLogin
    MaliciousUpload -->|"THREATENS"| AdminPost
    CommentXSS -->|"THREATENS"| UserComment
    
    %% Left to Right Flow - Mitigation Connections
    RateLimit -->|"MITIGATES"| CredentialStuffing
    FileValidation -->|"MITIGATES"| MaliciousUpload
    InputSanit -->|"MITIGATES"| CommentXSS
    
    %% Styling
    classDef actor fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
    classDef usecase fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    classDef misuse fill:#ffebee,stroke:#f44336,stroke-width:2px
    classDef mitigation fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef legend fill:#f5f5f5,stroke:#9e9e9e,stroke-width:1px
    
    class User,Admin,Attacker actor
    class UserLogin,AdminPost,UserComment usecase
    class CredentialStuffing,MaliciousUpload,CommentXSS misuse
    class RateLimit,FileValidation,InputSanit mitigation
    class Legend legend
                </div>
            </div>

            <div class="description">
                <h3>Use & Misuse Analysis</h3>
                <p>This diagram clearly shows legitimate user actions versus malicious attack scenarios, with explicit "Threaten" and "Mitigation" connections demonstrating how security controls protect against misuse cases.</p>
            </div>
        </div>

        <div class="footer">
            <p><strong>WordPress Threat Modeling Analysis</strong></p>
            <p>Repository: <a href="https://github.com/TRUPALIX9/study-reports">https://github.com/TRUPALIX9/study-reports</a></p>
            <p>All diagrams created using Mermaid.js and draw.io threat modeling shapes</p>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
    </script>
</body>
</html>
