<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L04: Ready, Set, Stop That Threat! - WordPress Threat Modeling Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c3e50;
        }
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .diagram-section {
            margin: 40px 0;
            padding: 30px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background-color: #fafafa;
        }
        .diagram-section h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .diagram-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .description {
            background-color: #e8f4f8;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
        .description h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .requirements {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .requirements h4 {
            color: #856404;
            margin-top: 0;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #ecf0f1;
            color: #7f8c8d;
        }
        .mermaid {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>L04: Ready, Set, Stop That Threat!</h1>
            <p><strong>WordPress Threat Modeling Analysis</strong></p>
            <p>¬©2025 Richard Zins CC BY-NC-SA 4.0</p>
            <p>Student: Trupal Patel | Course: Cybersecurity Threat Modeling</p>
        </div>

        <!-- Task 2: Data Flow Diagram -->
        <div class="diagram-section">
            <h2>Task 2: Data Flow Diagram (DFD) - 3 Points</h2>
            
            <div class="requirements">
                <h4>Requirements Met:</h4>
                <ul>
                    <li>‚úÖ 2 data flows (User Request Processing + Admin Operations)</li>
                    <li>‚úÖ 2 boundaries (Environment + Data)</li>
                    <li>‚úÖ Proper threat modeling shapes (External Entity, Process, Data Store, Trust Boundary)</li>
                </ul>
            </div>

            <div class="description">
                <h3>Enhanced User Browser Representation</h3>
                <p>The DFD includes detailed User Browser components with modern security features including SSL/TLS encryption, cookie management, and session storage capabilities.</p>
            </div>

            <div class="diagram-container">
                <div class="mermaid">
graph TD
    %% External Entities
    User[("üåê User Browser<br/>(Chrome/Firefox/Safari)<br/>‚Ä¢ SSL/TLS Encryption<br/>‚Ä¢ Cookie Management<br/>‚Ä¢ Session Storage")]
    Admin[("üëë Admin Dashboard<br/>(WordPress Admin Panel)<br/>‚Ä¢ Elevated Privileges<br/>‚Ä¢ Content Management<br/>‚Ä¢ Plugin Configuration")]
    
    %% Trust Boundary 1: Environment
    subgraph TB1 ["üåê Environment Boundary: Internet to Web Server"]
        WebServer["üåê Web Server<br/>(Apache/Nginx)<br/>‚Ä¢ Static File Serving<br/>‚Ä¢ Request Routing<br/>‚Ä¢ SSL/TLS Handling"]
    end
    
    %% Trust Boundary 2: Data
    subgraph TB2 ["üóÑÔ∏è Data Boundary: Application to Database"]
        WordPressApp["‚öôÔ∏è WordPress Core<br/>(Process)<br/>‚Ä¢ Request Processing<br/>‚Ä¢ Plugin Execution<br/>‚Ä¢ Theme Rendering"]
        MySQL[("üóÉÔ∏è MySQL Database<br/>(Data Store)<br/>‚Ä¢ Posts & Pages<br/>‚Ä¢ User Accounts<br/>‚Ä¢ Plugin Data<br/>‚Ä¢ Configuration")]
    end
    
    %% Core Data Flow 1: User Request
    User -->|"1. HTTPS Request<br/>(GET/POST with SSL/TLS)"| WebServer
    WebServer -->|"2. Process Request<br/>(PHP Execution)"| WordPressApp
    WordPressApp -->|"3. Query Database<br/>(SELECT/INSERT/UPDATE)"| MySQL
    MySQL -->|"4. Return Data<br/>(Query Results)"| WordPressApp
    WordPressApp -->|"5. Render HTML<br/>(Final Page)"| WebServer
    WebServer -->|"6. HTTPS Response<br/>(Complete Page)"| User
    
    %% Core Data Flow 2: Admin Operations
    Admin -->|"7. Admin Login<br/>(POST /wp-admin)"| WebServer
    WebServer -->|"8. Authenticate User<br/>(Session Management)"| WordPressApp
    WordPressApp -->|"9. Admin Database Query<br/>(User Permissions)"| MySQL
    MySQL -->|"10. Admin Data Response<br/>(Dashboard Data)"| WordPressApp
    WordPressApp -->|"11. Admin Interface<br/>(Dashboard Rendering)"| WebServer
    WebServer -->|"12. Admin Dashboard<br/>(Secure Response)"| Admin
    
    %% Styling
    classDef external fill:#e1f5fe,stroke:#2196f3,stroke-width:2px
    classDef process fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef datastore fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    classDef trustboundary fill:#fff3e0,stroke:#ff9800,stroke-width:3px,stroke-dasharray: 5 5
    
    class User,Admin external
    class WebServer,WordPressApp process
    class MySQL datastore
    class TB1,TB2 trustboundary
                </div>
            </div>

            <div class="description">
                <h3>Key Data Flows Explained</h3>
                <p><strong>Data Flow 1 (Steps 1-6):</strong> User Request Processing - Complete cycle from browser request to rendered page delivery</p>
                <p><strong>Data Flow 2 (Steps 7-12):</strong> Admin Operations - Secure authentication and dashboard access flow</p>
            </div>
        </div>

        <!-- Task 3: Threat Tree Diagram -->
        <div class="diagram-section">
            <h2>Task 3: Threat Tree Diagram (TTD) - 3 Points</h2>
            
            <div class="requirements">
                <h4>Requirements Met:</h4>
                <ul>
                    <li>‚úÖ 3 vulnerabilities (Weak Authentication, SQL Injection, XSS)</li>
                    <li>‚úÖ 3 countermeasures (MFA, Parameterized Queries, Input Sanitization)</li>
                    <li>‚úÖ Proper threat tree structure (root ‚Üí vulnerabilities ‚Üí attack methods ‚Üí countermeasures)</li>
                </ul>
            </div>

            <div class="diagram-container">
                <div class="mermaid">
graph TD
    %% Root Threat
    Root["üî• Compromise of WordPress<br/>Website Integrity and User Data<br/>(Root Threat)"]
    
    %% Level 1 - Vulnerabilities (3 Required)
    WeakAuth["üîê Weak Authentication<br/>(Vulnerability)<br/>‚Ä¢ Weak passwords<br/>‚Ä¢ Missing 2FA<br/>‚Ä¢ Session hijacking"]
    SQLInj["üíâ SQL Injection<br/>(Vulnerability)<br/>‚Ä¢ Unsanitized input<br/>‚Ä¢ Dynamic queries<br/>‚Ä¢ Plugin vulnerabilities"]
    XSS["üåê Cross-Site Scripting (XSS)<br/>(Vulnerability)<br/>‚Ä¢ Unescaped output<br/>‚Ä¢ Comment injection<br/>‚Ä¢ Stored/Reflected XSS"]
    
    %% Level 2 - Specific Attack Methods
    BruteForce["üí• Brute Force Attacks<br/>(Attack Method)"]
    PluginSQLi["üîå Plugin SQL Injection<br/>(Attack Method)"]
    CommentXSS["üí¨ Comment XSS Injection<br/>(Attack Method)"]
    
    %% Countermeasures (3 Required)
    MFA["üîí Multi-Factor Authentication<br/>(Countermeasure)<br/>‚Ä¢ Complex passwords<br/>‚Ä¢ 2FA enforcement<br/>‚Ä¢ Session management"]
    ParamQueries["üìù Parameterized Queries<br/>(Countermeasure)<br/>‚Ä¢ Prepared statements<br/>‚Ä¢ ORM frameworks<br/>‚Ä¢ Input validation"]
    InputSanit["üßπ Input Sanitization<br/>(Countermeasure)<br/>‚Ä¢ Output escaping<br/>‚Ä¢ Content Security Policy<br/>‚Ä¢ XSS prevention"]
    
    %% Connections - Root to Vulnerabilities
    Root --> WeakAuth
    Root --> SQLInj
    Root --> XSS
    
    %% Connections - Vulnerabilities to Attack Methods
    WeakAuth --> BruteForce
    SQLInj --> PluginSQLi
    XSS --> CommentXSS
    
    %% Countermeasures mapped to vulnerabilities
    MFA -.->|"Mitigates"| WeakAuth
    ParamQueries -.->|"Mitigates"| SQLInj
    InputSanit -.->|"Mitigates"| XSS
    
    %% Styling
    classDef root fill:#ffebee,stroke:#f44336,stroke-width:4px
    classDef vulnerability fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef attack fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef countermeasure fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    
    class Root root
    class WeakAuth,SQLInj,XSS vulnerability
    class BruteForce,PluginSQLi,CommentXSS attack
    class MFA,ParamQueries,InputSanit countermeasure
                </div>
            </div>

            <div class="description">
                <h3>Threat Tree Analysis</h3>
                <p>This diagram follows OWASP Top 10 web application security risks and shows direct 1:1 countermeasure mapping for each vulnerability type, demonstrating comprehensive threat modeling for WordPress.</p>
            </div>
        </div>

        <!-- Task 4: Use & Misuse Diagram -->
        <div class="diagram-section">
            <h2>Task 4: Use & Misuse Diagram (UMD) - 3 Points</h2>
            
            <div class="requirements">
                <h4>Requirements Met:</h4>
                <ul>
                    <li>‚úÖ 3 use cases (User Login, Admin Post, User Comment)</li>
                    <li>‚úÖ 3 misuse cases (Credential Stuffing, Malicious Upload, XSS Injection)</li>
                    <li>‚úÖ "Threaten" and "Mitigation" connections clearly outlined</li>
                </ul>
            </div>

            <div class="diagram-container">
                <div class="mermaid">
graph TB
    %% Actors
    User[("üë§ User<br/>(Actor)")]
    Admin[("üëë Admin<br/>(Actor)")]
    Attacker[("‚ö†Ô∏è Malicious Attacker<br/>(Actor)")]
    
    %% Use Cases
    UserLogin["üîê User Logs Into Account<br/>(Use Case)"]
    AdminPost["‚úçÔ∏è Admin Publishes a Post<br/>(Use Case)"]
    UserComment["üí¨ User Comments on a Post<br/>(Use Case)"]
    
    %% Misuse Cases
    CredentialStuffing["üíÄ Credential Stuffing Attack<br/>(Misuse Case)"]
    MaliciousUpload["‚ò†Ô∏è Malicious File Upload<br/>(Misuse Case)"]
    CommentXSS["üï∑Ô∏è Comment XSS Injection<br/>(Misuse Case)"]
    
    %% Mitigations
    RateLimit["üö¶ Rate Limiting & MFA<br/>(Mitigation)"]
    FileValidation["‚úÖ File Type Validation<br/>(Mitigation)"]
    InputSanit["üßπ Input Sanitization<br/>(Mitigation)"]
    
    %% Legitimate Actor Connections
    User --> UserLogin
    User --> UserComment
    Admin --> AdminPost
    
    %% Threaten Connections (Red dashed lines)
    CredentialStuffing -.->|"üö´ THREATENS"| UserLogin
    MaliciousUpload -.->|"üö´ THREATENS"| AdminPost
    CommentXSS -.->|"üö´ THREATENS"| UserComment
    
    %% Attacker to Misuse Cases
    Attacker --> CredentialStuffing
    Attacker --> MaliciousUpload
    Attacker --> CommentXSS
    
    %% Mitigation Connections (Green solid lines)
    RateLimit -->|"‚úÖ MITIGATES"| CredentialStuffing
    FileValidation -->|"‚úÖ MITIGATES"| MaliciousUpload
    InputSanit -->|"‚úÖ MITIGATES"| CommentXSS
    
    %% Legend
    subgraph Legend ["üìã Legend"]
        Threaten["üö´ THREATENS<br/>(Dashed Red Line)"]
        Mitigates["‚úÖ MITIGATES<br/>(Solid Green Line)"]
        Normal["‚û°Ô∏è NORMAL FLOW<br/>(Solid Blue Line)"]
    end
    
    %% Styling
    classDef actor fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
    classDef usecase fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    classDef misuse fill:#ffebee,stroke:#f44336,stroke-width:2px
    classDef mitigation fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef legend fill:#f5f5f5,stroke:#9e9e9e,stroke-width:1px
    
    class User,Admin,Attacker actor
    class UserLogin,AdminPost,UserComment usecase
    class CredentialStuffing,MaliciousUpload,CommentXSS misuse
    class RateLimit,FileValidation,InputSanit mitigation
    class Legend legend
                </div>
            </div>

            <div class="description">
                <h3>Use & Misuse Analysis</h3>
                <p>This diagram clearly shows legitimate user actions versus malicious attack scenarios, with explicit "Threaten" and "Mitigation" connections demonstrating how security controls protect against misuse cases.</p>
            </div>
        </div>

        <div class="footer">
            <p><strong>WordPress Threat Modeling Analysis</strong></p>
            <p>Repository: <a href="https://github.com/TRUPALIX9/study-reports">https://github.com/TRUPALIX9/study-reports</a></p>
            <p>All diagrams created using Mermaid.js and draw.io threat modeling shapes</p>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
    </script>
</body>
</html>
